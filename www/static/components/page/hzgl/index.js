define("components/page/hzgl/index",function(t,n,a){var e=t("vue.js"),d=t("components/common/BasePage.js");t("datapager/index.js"),a.exports=e.extend({mixins:[d],className:"hzgl",template:'<div id="hzgl" class="hzgl page">\n    <div class="search-panel">\n        <h1>流水搜索</h1>\n\n        <div class="search-warp">\n            <span class="form-group">\n                <label>\n                    确认人:\n                </label>\n               <input type="text" lazy v-model="searchInfo.confirmer"\n                      class="form-control">\n            </span>\n            <span class="form-group">\n                <label>\n                    流水号:\n                </label>\n               <input type="text" lazy v-model="searchInfo.transactionId"\n                      class="form-control">\n            </span>\n\n            <span class="form-group">\n                <label>\n                    司机支付时间:\n                </label>\n               <input Jid="startTime" type="text" lazy v-model="searchInfo.paidStartTime"\n                      class="form-control ">\n                 至\n               <input Jid="endTime" type="text" lazy v-model="searchInfo.paidEndTime"\n                      class="form-control">\n            </span>\n\n            <div class="btn yellow search" v-touch:tap="search">\n                查询\n            </div>\n            <div class="btn blue search" v-touch:tap="getMoney">\n                申请提现\n            </div>\n        </div>\n    </div>\n    <div class="nav-panel clearfix">\n\n    </div>\n    <div class="list-panel">\n        <div class="table">\n            <div class="thead">\n                <ttd >\n                    <input type="checkbox"  v-touch:tap="toggleSelectAll($event)">\n                </ttd>\n                <ttd >序号</ttd>\n                <ttd >流水号</ttd>\n                <ttd >确认人</ttd>\n                <ttd >确认时间</ttd>\n                <ttd >金额</ttd>\n                <ttd >折扣</ttd>\n                <ttd >应收金额</ttd>\n                <ttd >提现时间</ttd>\n                <ttd >支付时间</ttd>\n            </div>\n            <div class="tbody">\n                <div v-repeat="item in ggInfo.lists" v-touch:tap="info($event,item)">\n                    <ttd>\n                        <input type="checkbox"  value="{{item.id}}" disabled="{{item.applyStatus!=0}}">\n                    </ttd>\n                    <ttd>{{$index}}</ttd>\n                    <ttd>{{item.id}}</ttd>\n                    <ttd>{{item.confirmer}}</ttd>\n                    <ttd>{{item.confirmTime | datetime}}</ttd>\n                    <ttd>{{item.totalAmount | moneyFormat}}元</ttd>\n                    <ttd>{{item.discount}}</ttd>\n                    <ttd>{{item.paidAmount |moneyFormat}}元</ttd>\n                    <ttd>{{item.applyTime | datetime}}</ttd>\n                    <ttd>{{item.paidTime | datetime}}</ttd>\n\n                </div>\n                <div>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd >合计:{{ggInfo.allTotalAmount|moneyFormat}}元</ttd>\n                    <ttd ></ttd>\n                    <ttd >合计:{{ggInfo.allPaidAmount|moneyFormat}}元</ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                </div>\n                <div>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                    <ttd ></ttd>\n                </div>\n\n            </div>\n        </div>\n        <div class="dataPageWarp">\n            <c-datapager params="{{ggInfo.pagerInfo}}"></c-datapager>\n        </div>\n    </div>\n</div>\n',pageName:"流水管理",data:function(){return{searchInfo:{confirmer:"",paidStartTime:"",paidEndTime:"",transactionId:""},ggInfo:{allTotalAmount:0,allPaidAmount:0,lists:[],pagerInfo:{all:0,curr:1}},cacheList:{}}},ready:function(){var t=this;t.$on("datapager.change",function(n){Util.log(t.ggInfo.pagerInfo.curr),t.ggInfo.pagerInfo.curr=n,t.$options.loadPage(n)});var n={theme:"baoxian",lang:"zh",display:"modal",dateFormat:"yy/mm/dd",startYear:(new Date).getFullYear()-2,endYear:(new Date).getFullYear(),controls:["calendar"]};t.Jdom.startTime.mobiscroll().calendar(n),t.Jdom.endTime.mobiscroll().calendar(n)},loadPage:function(t){var n=this.vue;t=t||1,n.pageindex=t;var a=$.extend({count:5,page:t},n.searchInfo);a.paidStartTime&&(a.paidStartTime=Date.parse(new Date(a.paidStartTime+" 0:0"))),a.paidEndTime&&(a.paidEndTime=Date.parse(new Date(a.paidEndTime+" 23:59"))),Util.log("--------------加载 consignor_search------------"),Server.ajax({action:"vendor_admin/transactions",type:"GET",data:a,needLoading:!0,success:function(t){var a=n.ggInfo.lists=t.info.datas;n.ggInfo.allTotalAmount=0,n.ggInfo.allPaidAmount=0,n.cacheList={};for(var e=0;e<a.length;e++){var d=a[e];d.paidAmount=d.totalAmount*d.discount,n.ggInfo.allTotalAmount=n.ggInfo.allTotalAmount+(d.totalAmount-0),n.ggInfo.allPaidAmount=n.ggInfo.allPaidAmount+(d.paidAmount-0),n.cacheList[d.id]=d}n.ggInfo.allTotalAmount=n.ggInfo.allTotalAmount,n.ggInfo.allPaidAmount=n.ggInfo.allPaidAmount,n.ggInfo.pagerInfo.all=t.info.totalPage,n.$broadcast("dataPager.allChange")}})},attached:function(){var t=this;t.searchInfo={confirmer:"",paidStartTime:"",paidEndTime:"",transactionId:""},t.$options.loadPage()},isCanGetMoney:function(t){this.vue;return!0},methods:{toggleSelectAll:function(t){var n=this,a=t.target;$(n.$el).find(".tbody input[type=checkbox]").each(function(){var t=$(this);t[0].checked=a.checked})},info:function(){},search:function(){var t=this;t.ggInfo.pagerInfo.curr=1,t.$options.loadPage()},getMoney:function(){var t=this,n=[];$(t.$el).find(".tbody input[type=checkbox]").each(function(){var t=$(this),a=t.attr("value");t[0].checked&&n.push(a)}),t.$options.isCanGetMoney(n)&&Server.ajax({action:"vendor_admin/applyDeposition",type:"POST",data:{transactionNos:n},needLoading:!0,success:function(){alert("提现成功"),t.$options.loadPage(t.pageindex)}})}},filters:{addTotalAmount:function(t){var n=this;return Util.log("toalamount",t),Util.log("allTotalAmount",n.ggInfo.allTotalAmount),t},addPaidAmount:function(t){var n=this;return n.ggInfo.allPaidAmount=n.ggInfo.allPaidAmount+(t-0),t}}})});